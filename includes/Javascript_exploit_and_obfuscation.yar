/*
   Yara Rule Set
   Author: 
   Date: 2019-01-31
   Identifier: 01-31-19
   Reference: https://github.com/Yara-Rules/rules/blob/b496aadd3099c9d0955685d450b9fd2c871b1ce8/Packers/Javascript_exploit_and_obfuscation.yar
   Reference: https://github.com/Yara-Rules/rules
*/

rule possible_includes_base64_packed_functions  
{ 
	meta: 
		impact = 5 
		hide = true 
		desc = "Detects possible includes and packed functions" 
	strings: 
		$f = /(atob|btoa|;base64|base64,)/ nocase
		//$ff = /(?:[A-Za-z0-9]{4}){2,}(?:[A-Za-z0-9]{2}[AEIMQUYcgkosw048]=|[A-Za-z0-9][AQgw]==)/ nocase 
		$fff = /([A-Za-z0-9]{4})*([A-Za-z0-9]{2}==|[A-Za-z0-9]{3}=|[A-Za-z0-9]{4})/ 
	condition: 
		$f and $fff
}
